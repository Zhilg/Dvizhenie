<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤</title>
    <link rel="stylesheet" href="../assets/css/clusterization.css">
</head>
<body>
    <div class="container">
        <header>
            <div class="header-title">–ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤</div>
            <div class="header-controls">
                <a href="/" class="home-btn">üè† –î–æ–º–æ–π</a>
                <button id="exportBtn" class="btn btn-primary" disabled>üìä –≠–∫—Å–ø–æ—Ä—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</button>
            </div>
        </header>
        
        <div id="noCorpusMessage" class="card hidden">
            <div class="card-body text-center">
                <h3 class="card-title">–ö–æ—Ä–ø—É—Å—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</h3>
                <p class="card-text">–î–ª—è –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã –∑–∞–≥—Ä—É–∑–∏—Ç–µ –≤–∞—à –ø–µ—Ä–≤—ã–π –∫–æ—Ä–ø—É—Å –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤</p>
                <a href="/upload" class="btn btn-primary btn-lg">
                    <i class="bi bi-cloud-upload"></i> –ó–∞–≥—Ä—É–∑–∏—Ç—å –ø–µ—Ä–≤—ã–π –∫–æ—Ä–ø—É—Å
                </a>
            </div>
        </div>

        <aside class="sidebar">            
            <div class="control-group">
                <label for="corpusSelect">–í—ã–±–æ—Ä –∫–æ—Ä–ø—É—Å–∞:</label>
                <select id="corpusSelect" class="form-control">
                    <option value="">–ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ—Ä–ø—É—Å–æ–≤...</option>
                </select>
                <div id="noCorpusMessage" class="no-corpus-message" style="display: none;">
                    <p>–ö–æ—Ä–ø—É—Å—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</p>
                    <a href="/upload" class="btn btn-primary">–ü–µ—Ä–µ–π—Ç–∏ –∫ –∑–∞–≥—Ä—É–∑–∫–µ</a>
                </div>
            </div>
            
            <div class="control-group">
                <button id="startClusteringBtn" class="btn btn-success">
                    üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç—å –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—é
                </button>
            </div>
            
            <div class="control-group">
                <label for="jsonUpload">–ó–∞–≥—Ä—É–∑–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∏–∑ JSON:</label>
                <input type="file" id="jsonUpload" accept=".json" style="display: none;">
                <button id="uploadBtn" class="btn btn-info">üìÅ –ó–∞–≥—Ä—É–∑–∏—Ç—å JSON —Ñ–∞–π–ª</button>
            </div>
            
            <div class="control-group">
                <label for="clusterLimit">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º—ã—Ö –∫–ª–∞—Å—Ç–µ—Ä–æ–≤:</label>
                <div style="display: flex; gap: 8px; align-items: center;">
                    <select id="clusterLimit" class="form-control" style="flex: 1;">
                        <option value="5">5</option>
                        <option value="10" selected>10</option>
                        <option value="15">15</option>
                        <option value="20">20</option>
                        <option value="50">50</option>
                        <option value="100">100</option>
                        <option value="custom">–î—Ä—É–≥–æ–µ</option>
                    </select>
                    <input type="number" id="clusterLimitCustom" class="form-control"
                           style="flex: 1; display: none;"
                           placeholder="–í–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–æ"
                           min="1"
                           max="1000">
                </div>
            </div>

            <div class="control-group">
                <label for="fileSearch">–ü–æ–∏—Å–∫ —Ñ–∞–π–ª–∞ –≤ –∫–ª–∞—Å—Ç–µ—Ä–∞—Ö:</label>
                <div style="display: flex; gap: 8px; margin-bottom: 10px;">
                    <input type="text" id="fileSearch" class="form-control"
                           placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–º—è —Ñ–∞–π–ª–∞ –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏..."
                           style="flex: 1;">
                    <button id="clearSearchBtn" class="btn btn-secondary" style="min-width: 80px; display: none;">‚úï –°–±—Ä–æ—Å–∏—Ç—å</button>
                </div>
                <div id="searchInfo" style="display: none; padding: 8px; background: #e7f3ff; border-radius: 4px; margin-bottom: 8px; font-size: 13px; color: #0066cc;">
                    <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö –ø–æ–∏—Å–∫–∞ -->
                </div>
            </div>

            <div class="control-group">
                <label id="clustersLabel">–ö–ª–∞—Å—Ç–µ—Ä—ã:</label>
                <div class="cluster-tree-wrapper">
                    <div class="tree-controls">
                        <button class="tree-btn" onclick="expandAll()">üìÇ –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –≤—Å–µ</button>
                        <button class="tree-btn" onclick="collapseAll()">üìÅ –°–≤–µ—Ä–Ω—É—Ç—å –≤—Å–µ</button>
                        <button class="tree-btn" onclick="toggleCompactMode()">üîç –ö–æ–º–ø–∞–∫—Ç–Ω–æ</button>
                    </div>
                    <div class="cluster-tree-container">
                        <div id="clusterTree" class="cluster-tree">
                            <!-- –î–µ—Ä–µ–≤–æ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ –±—É–¥–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ –∑–¥–µ—Å—å -->
                        </div>
                    </div>
                    <div class="scroll-indicator" id="scrollIndicator"></div>
                </div>
            </div>
        </aside>
        
        <main class="main-content">
            <div class="status-bar">
                <div id="statusMessage" class="status-message">
                    <div class="status-indicator"></div>
                    <span id="statusText">–ì–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ</span>
                </div>
                <div class="timer-container">
                    <span>–í—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏: </span>
                    <span id="timer" class="timer">00:00:00</span>
                </div>
                <div class="progress-container">
                    <div id="progressBar" class="progress-bar" style="width: 0%"></div>
                </div>
            </div>
            
            <div class="panel">
                <div class="panel-header">
                    <span>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–ª–∞—Å—Ç–µ—Ä–µ </span>
                    <span id="clusterInfo">–í—ã–±–µ—Ä–∏—Ç–µ –∫–ª–∞—Å—Ç–µ—Ä –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –¥–µ—Ç–∞–ª–µ–π</span>
                </div>
                <div class="panel-body">
                    <div class="chart-container" id="chartContainer">
                        <!-- Chart will be rendered here via JavaScript -->
                        <div style="padding: 20px; text-align: center; color: #666;">
                            –í—ã–±–µ—Ä–∏—Ç–µ –∫–ª–∞—Å—Ç–µ—Ä –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –≥—Ä–∞—Ñ–∏–∫–∞ —Å—Ö–æ–∂–µ—Å—Ç–∏
                        </div>
                    </div>

                    <div id="visualizationsContainer" style="margin-top: 20px; display: none;">
                        <h4>–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏</h4>
                    </div>
                </div>
            </div>
            
            <div class="panel_documents">
                <div class="panel-header">
                    <span>–î–æ–∫—É–º–µ–Ω—Ç—ã –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ</span>
                </div>
                <div class="panel-body">
                    <table class="files-table">
                        <thead class="files-table-header">
                            <tr>
                                <th data-sort="filename">–ò–º—è —Ñ–∞–π–ª–∞</th>
                                <th data-sort="size">–†–∞–∑–º–µ—Ä</th>
                                <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                            </tr>
                        </thead>
                    </table>
                    <div class="files-table-body-container">
                        <table class="files-table">
                            <tbody id="filesTableBody">
                                <tr>
                                    <td colspan="4" style="text-align: center; padding: 30px;">
                                        –í—ã–±–µ—Ä–∏—Ç–µ –∫–ª–∞—Å—Ç–µ—Ä –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <div class="panel">
                <div class="panel-header">
                    <span id="previewTitle">–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –¥–æ–∫—É–º–µ–Ω—Ç–∞</span>
                </div>
                <div class="panel-body">
                    <div id="previewContent" class="preview-container">
                        –í—ã–±–µ—Ä–∏—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç –¥–ª—è –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script src="../assets/js/backend-selector.js"></script>
    <script type="text/javascript" src="../assets/js/clusterization.js"></script>
</body>
</html>